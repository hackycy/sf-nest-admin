# 文档修订记录

| 日期       | 版本   | 说明             | 作者    |
| :--------- | :----- | :--------------- | :------ |
| 2020-08-21 | v1.0.0 | 创建             | hackycy |
| 2021-09-27 | v2.0.0 | 增加sys_config表 | hackycy |

# 参考文献

https://blog.csdn.net/gglinux/article/details/68948901

https://www.zybuluo.com/stonezhou/note/1292262

http://www.csdeshang.com/home/dsmall/database.html

# 数据模型实体属性

## sys_menu

**表注释： 系统菜单**

| 字段      | 类型         | 空   | 默认 | 注释                            |
| --------- | ------------ | ---- | ---- | ------------------------------- |
| id        | int(20)      | 否   |      | ID                              |
| parent_id | int(20)      |      |      | 父菜单ID                        |
| name      | varchar(255) | 否   |      | 菜单名称                        |
| router    | varchar(255) |      |      | 菜单地址                        |
| perms     | varchar(255) |      |      | 权限标识                        |
| type      | tinyint(4)   | 否   | 0    | 类型，0：目录、1：菜单、2：按钮 |
| icon      | varchar(255) |      |      | 对应图标                        |
| order_num | int(11)      |      | 0    | 排序                            |
| view_path | varchar(255) |      |      | 视图地址，对应vue文件           |
| keepalive | boolean      |      | true | 路由缓存                        |
| Is_show   | boolean      |      | true | 是否显示在菜单栏                |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段   | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ------ | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id     | 0    | A        | 否   |      |

## sys_department

**表注释：系统部门**

| 字段      | 类型         | 空   | 默认 | 注释       |
| --------- | ------------ | ---- | ---- | ---------- |
| id        | int(20)      | 否   |      | ID         |
| parent_id | int(20)      |      |      | 上级部门ID |
| name      | varchar(255) | 否   |      | 部门名称   |
| order_num | int(11)      |      | 0    | 排序       |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段 | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ---- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id   | 0    | A        | 否   |      |

## sys_user

**表注释：系统用户**

| 字段          | 类型         | 空   | 默认 | 注释                                       |
| ------------- | ------------ | ---- | ---- | ------------------------------------------ |
| id            | int(20)      | 否   |      | ID                                         |
| department_id | int(20)      | 否   |      | 部门编号                                   |
| name          | varchar(255) | 否   |      | 姓名                                       |
| username      | varchar(255) | 否   |      | 登录账号                                   |
| password      | varchar(255) | 否   |      | 密码                                       |
| psalt         | varchar(32)  | 否   |      | 密码盐值（随机生成，每个用户对应一个盐值） |
| nick_name     | varchar(255) |      |      | 昵称                                       |
| head_img      | varchar(255) |      |      | 头像                                       |
| email         | varchar(255) |      |      | 邮箱                                       |
| phone         | varchar(20)  |      |      | 手机号                                     |
| remark        | varchar(255) |      |      | 备注                                       |
| status        | tinyint(4)   |      | 1    | 状态：0：禁用，1：启用                     |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段     | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | -------- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id       | 0    | A        | 否   |      |
| UNIQUE  | BTREE | 是   | 否   | username |      |          | 否   |      |

## sys_role

**表注释：系统角色**

| 字段    | 类型         | 空   | 默认 | 注释   |
| ------- | ------------ | ---- | ---- | ------ |
| id      | int(20)      | 否   |      | ID     |
| user_id | varchar(255) | 否   |      | 创建人 |
| name    | varchar(255) | 否   |      | 名称   |
| label   | varchar(50)  | 否   |      | 标签   |
| remark  | varchar(255) |      |      | 备注   |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段  | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ----- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id    | 0    | A        | 否   |      |
| UNIQUE  | BTREE | 是   | 否   | label |      | A        | 否   |      |
| UNIQUE  | BTREE | 是   | 否   | name  |      | A        | 否   |      |

## sys_role_department

**表注释：系统角色部门关系**

| 字段          | 类型    | 空   | 默认 | 注释   |
| ------------- | ------- | ---- | ---- | ------ |
| id            | int(20) | 否   |      | ID     |
| role_id       | int(20) | 否   |      | 角色ID |
| department_id | int(20) | 否   |      | 部门ID |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段 | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ---- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id   | 0    | A        | 否   |      |

## sys_role_menu

**表注释：系统角色菜单关系**

| 字段    | 类型    | 空   | 默认 | 注释   |
| ------- | ------- | ---- | ---- | ------ |
| id      | int(20) | 否   |      | ID     |
| role_id | int(20) | 否   |      | 角色ID |
| menu_id | int(20) | 否   |      | 菜单ID |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段 | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ---- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id   | 0    | A        | 否   |      |

## sys_user_role

**表注释：系统用户角色关系**

| 字段    | 类型    | 空   | 默认 | 注释   |
| ------- | ------- | ---- | ---- | ------ |
| id      | int(20) | 否   |      | ID     |
| user_id | int(20) | 否   |      | 用户ID |
| role_id | int(20) | 否   |      | 角色ID |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段 | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ---- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id   | 0    | A        | 否   |      |

## sys_login_log

**表注释：登录日志表**

| 字段    | 类型         | 空   | 默认 | 注释                         |
| ------- | ------------ | ---- | ---- | ---------------------------- |
| id      | int(20)      | 否   |      | ID                           |
| user_id | int(20)      |      |      | 登录的用户id                 |
| ip      | varchar(255) |      |      | 登录ip                       |
| time    | datetime     |      |      | 登陆时间（未使用，保留字段） |
| ua      | varchar(500) |      |      | user-agent                   |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段 | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ---- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id   | 0    | A        | 否   |      |

## sys_task

**表注释：系统任务表**

| 字段       | 类型         | 空   | 默认 | 注释                                  |
| ---------- | ------------ | ---- | ---- | ------------------------------------- |
| id         | int(20)      | 否   |      | ID                                    |
| name       | varchar(50)  | 否   |      | 任务名称                              |
| service    | varchar(255) | 否   |      | 需要执行的service                     |
| type       | tinyint(4)   | 否   | 0    | 任务模式：0为cron，1为时间间隔        |
| status     | tinyint(1)   |      | 0    | 任务状态：0为停止，1为运行            |
| start_time | datetime     |      |      | 任务开始时间，type为0时生效           |
| end_time   | datetime     |      |      | 任务结束时间，type为0时生效           |
| limit      | int          |      | 0    | 最大执行次数，小于或者等于0则不限次数 |
| cron       | varchar(255) |      |      | cron表达式，type为0时生效             |
| every      | int          |      |      | 执行间隔，type为1时生效               |
| data       | text         |      |      | 传入数据                              |
| job_opts   | text         |      |      | bull job options                      |
| remark     | varchar(255) |      |      | 备注                                  |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段 | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ---- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id   | 0    | A        | 否   |      |
| UNIQUE  | BTREE | 是   | 否   | name |      | A        | 否   |      |

## sys_task_log

**表注释：任务日志表**

| 字段    | 类型       | 空   | 默认 | 注释                                  |
| ------- | ---------- | ---- | ---- | ------------------------------------- |
| id      | int(20)    | 否   |      | id                                    |
| task_id | int(20)    | 否   |      | 对应任务id                            |
| status  | Tinyint(4) | 否   | 0    | 任务状态：0为失败，1为成功 |
| detail  | Text       |      |      | 任务详情                              |
| consume_time | int(20) | | 0 | 任务完成耗时 (ms) |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段 | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ---- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id   | 0    | A        | 否   |      |

## sys_config

**表注释：系统参数配置表**

| 字段   | 类型         | 空   | 默认 | 注释         |
| ------ | ------------ | ---- | ---- | ------------ |
| id     | int(20)      | 否   |      | id           |
| key    | varchar(50)  | 否   |      | 参数配置键   |
| value  | varchar(255) | 是   |      | 参数配置值   |
| name   | varchar(50)  | 否   |      | 参数配置名称 |
| remark | varchar(255) | 是   |      | 参数配置备注 |

**索引**

| 键名    | 类型  | 唯一 | 紧凑 | 字段 | 基数 | 排序规则 | 空   | 注释 |
| ------- | ----- | ---- | ---- | ---- | ---- | -------- | ---- | ---- |
| PRIMARY | BTREE | 是   | 否   | id   | 0    | A        | 否   |      |
| UNIQUE  | BTREE | 是   | 否   | key  |      | A        | 否   |      |
